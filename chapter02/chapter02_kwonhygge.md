# HTTP 완벽 가이드 2장

## URI와 리소스

- URL은 인터넷의 리소스를 가리키는 표준 이름

## 2.1 인터넷의 리소스 탐색하기

URI = URL + URN

URN : 현재 그 리소스가 어디에 존재하든 상관없이 그 이름만으로 리소스를 식별

URL: 리소스가 어디 있는지 설명해서 리소스를 식별

[http://www.joes-hardware.com/seasonal/index-fall.html](http://www.joes-hardware.com/seasonal/index-fall.html) 이라는 URL을 불러오고 싶을 때

- URL의 첫부분인 http는 URL의 스킴 : 웹 클라이언트가 리소스에 어떻게 접근하는지 알려줌(URL이 HTTP 프로토콜을 사용한다)
- www.joes-hardware.com은 서버의 위치 : 웹 클라이언트가 리소스가 어디에 호스팅 되어있는지 알려주는 것
- seasonal/index-fall.html은 리소스의 경로: 서버에 존재하는 로컬 리소스들 중에서 요청받은 리소스가 무엇인지 알려줌

- HTTP 프로토콜이 아닌 다른 가용한 프로토콜
    - mailto:president@whitehouse.gov : 이메일 주소
    - [ftp://ftp.lots-o-books.com/pub/complete-price-list.xls](ftp://ftp.lots-o-books.com/pub/complete-price-list.xls) : FTP(File Transfer Protocol) 서버에 올라가 있는 파일
    - rtsp://www.joes-hardware.com:554/interview/cto_video : 스트리밍을 제공하기 위해 비디오 서버에 호스팅하고 있는 영화

처음부터 일관된 명명 방식이 있었던 것은 아님

### 2.1.1 URL이 있기 전 암흑의 시대

- 웹과 URL이 있기 전에 사람들은 네트워크상에 산재해 있는 데이터에 접근하기 위해 각자 다른분류 방식을 사용

URL이 있기 전 친구와 complete-price-list.xls라는 파일을 공유하려고 했다면

1. ftp.joes-hardware.com에 FTP로 접속해라
2. 익명 사용자로 로그인한 다음 비밀번호로 네 이름을 입력해라
3. pub 디렉토리로 이동해서 바이너리 형식으로 전환해라
4. 이제 complete-catalog.xls란 이름의 파일을 내려받아라

하지만 URL을 사용하면 "[ftp://ftp.lots-o-books.com/pub/complete-price-list.xls](ftp://ftp.lots-o-books.com/pub/complete-price-list.xls)를 열어봐" 라고 간단히

## 2.2 URL 문법

- URL 문법은 스킴에 따라서 달라지지만 형태와 문법 면에서 유사하다
- 대부분의 URL 스킴의 문법
    - <스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
    
|컴포넌트|설명|기본값|
|------|--|-----|
|스킴|리소스를 가져오려면 어떤 프로토콜을 사용하여 서버에 접근해야 하는지 가리킨다|없음|
|사용자 이름|몇몇 스킴은 리소스에 접근 하기 위해 사용자 이름을 필요로 한다|anonymous|
|비밀번호|사용자의 비밀번호를 가리키며, 사용자 이름에 콜론(:)으로 이어서 기술한다.|<이메일 주소>|
|호스트|리소스를 호스팅하는 서버의 호스트 명이나 IP 주소|없음|
|포트|리소스를 호스팅하는 서버가 열어놓은 포트번호. 많은 스킴이 기본 포트를 가지고 있다.(HTTP의 기본 포트는 80)|스킴에 따라 다름|
|경로|이전 컴포넌트와 빗금(/)으로 구분, 서버 내 리소스가 어디에 있는지 가리킴, 경로 컴포넌트의 문법은 서버와 스킴에 따라 다름|없음|
|파라미터|특정 스킴들에서 입력 파라미터를 기술하는 용도로 사용, 파라미터는 이름/값을 쌍으로 가짐, 다른 파라미터나 경로의 일부와 세미콜론으로 구분함, 여러개 가질 수 있음|없음
|질의|스킴에서 애플리케이션에 파라미터를 전달하는 데 쓰임, 질의 컴포넌트를 작성하는데 쓰이는 공통 포맷은 없음 URL의 끝에 ?로 구분|없음
|프래그먼트|리소스의 조각이나 일부분을 가리키는 이름, URL이 특정 객체를 가리킬 경우에 프래그먼트 필드는 서버에 전달되지 않음, 클라이언트에서만 사용, URL의 끝에서 # 문자로 구분|없음|

### 2.2.1 스킴: 사용할 프로토콜
- 스킴 컴포넌트는 알파벳으로 시작해야함
- URL 나머지 부분들과 첫번째 : 문자로 구분
- 스킴 명은 대소문자를 가리지 않음

### 2.2.2 호스트와 포트
- 호스트 컴포넌트: 접근하려고 하는 리소스를 가지고 있는 인터넷 상의 호스트 장비
- 포트 컴포넌트: 서버가 열어놓은 네트워크 포트

### 2.2.3 사용자 이름과 비밀번호
- 사용자 이름과 비밀번호를 기술하지 않고 FTP URL에 접근하면, 기본 사용자 이름 값으로 'anonymous', 비밀번호는 브라우저마다 가지고 있는 기본값을 사용한다.
- @문자를 사용해 URL로부터 둘을 분리

### 2.2.4 경로
- 경로는 계층적 파일 시스템 경로와 유사한 구조를 가짐
- '/' 문자를 기준으로 경로조각으로 나뉨

### 2.2.5 파라미터
- 많은 스킴이 객체에 대한 호스트 및 경로 정보만으로는 리소스를 찾지 못함
- 서버가 어떤 포트를 열어놓고 있는지 등 많은 프로토콜이 더 많은 정보를 요구함
- URL을 사용하는 애플리케이션이 리소스에 접근하려면 프로토콜 파라미터가 필요
- 예시
    - 바이너리와 텍스트, 두 개의 포맷을 지원하는 FTP
    - 사용자는 바이너리 이미지가 텍스트 형식으로 전송되는 것을 원하지 않음
- 파라미터 컴포넌트는 이름/값 쌍의 리스트로 ; 문자로 구분하여 URL에 기술
- 예시
    - ftp://prep.ai.mit.edu/pub/gnu;type=d
    - 이름은 type이고 값은 d인 파라미터를 전달
    
### 2.2.6 질의 문자열
- 데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해 질문이나 질의를 받을 수 있음
- 예시
    - 아이템 번호 12731의 재고가 있는지 확인하기 위해 사용되는 url
    - http://www.joes-hardware.com/inventory-check.cgi?item=12731
- 여러개의 질의는 &로 구분하여 전달

### 2.2.7 프래그먼트
- HTML 같은 리소스 형식들은 본래의 수준보다 더 작게 나뉠 수 있음
    - paragraph 가 포함된 용량이 큰 한개의 텍스트 문서의 경우, 그 리소스에 대한 URL은 텍스트 문서 전체를 가리키겠지만 이상적으로는 리소스안에 있는 특정 절을 가리킬 수 있어야 함
- 예시
    - http://www.joes-hardware.com/tools.html#drills
    - tools.html 웹페이지의 일부를 가리킴
    
## 2.3 단축 URL
- 웹 클라이언트는 몇몇 단축 URL을 인식하고 사용
- 상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 사용할 수 있음

### 2.3.1 상대 URL
- 지금까지 우리가 본 것들은 절대 URL
- ./hammers.html 같은 것
- 기저 URL
    - 상대 URL로의 변환 과정의 첫 단계는 기저 URL을 찾는 것
    - 리소스에서 명시적으로 제공
        - 어떤 리소스들은 기저 URL을 명확하게 기술하기도 함
        - 예를 들어 HTML 문서에서는 그 안에 있는 모든 상대 URL을 변경하기 위해서 기저 URL을 가리키는 <BASE> HTML 태그를 기술할 수 있음
    - 리소스를 포함하고 있는 기저 URL
        - 만약 상대 URL이 기저 URL이 명시되지 않은 리소스에 포함된 경우
    - 기저 URL이 없는 경우 : 절대 URL만으로 이루어져 있다는 뜻
    
### 2.3.2 URL 확장
- 어떤 브라우저들은 URL을 입력한 다음이나 입력하고 있는 동안에 자동으로 URL을 확장함 -> 빠르게 입력하게 도와줌
- 호스트명 확장
    - 확장 기능을 지원하는 브라우저는 단순한 휴리스틱만을 사용해서 입력한 호스트 명을 전체 호스트 명으로 확장할 수 있다
    - yahoo를 입력하면 브라우저는 호스트 명에 자동으로 www와 .com을 붙여서 www.yahoo.com을 만듦
    - 어떤 브라우저는 yahoo란 단어를 포함한 사이트를 찾지 못하면 확장을 포기하기 전에 몇가지의 URL을 추가로 제시
- 히스토리 확장
    - 과거에 사용자가 방문했던 URL의 기록을 저장해 놓는 것

## 2.4 안전하지 않은 문자
- 안전한 전송 필요 -> 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것을 의미
- 전자메일에 사용되는 SMTP 같은 프로토콜은 특정 문자를 제거할 수도 있는 전송 방식을 사용
- 문자가 제거되는 일을 피하고자 URL은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락
- 이스케이프라는 기능을 추가하여, 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 하였음

### 2.4.1 URL 문자집합
- 컴퓨터 시스템의 기본 문자 집합은 보통 영어 중심으로 설정되어 있음
- 역사적으로 많은 컴퓨터 애플리케이션이 US-ASCII 문자 집합을 사용해왔음
- US-ASCII는 문자를 서식화하고 하드웨어상에서 신호를 주고받기 위해, 7비트를 사용하여 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어 문자를 표현
- US-ASCII는 만들어진 지 오래된 문자 집합이기 때문에 적은 수의 문자만을 포함
    - 미국 시민이 아닌 사람들이 사용하기 불편
    - 특정 이진 데이터를 포함해야 하는 경우도 있음
    - 이런 것들을 지원하기 위해 URL 설계자들은 URL에 이스케이프 문자열을 쓸 수 있게 설계
- 이스케이프 문자열은 US-ASCII에서 사용이 금지된 문자들, 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성과 완성도를 높임

### 2.4.2 인코딩 체계
- 안전하지 않은 문자를 퍼센티지 기호로 시작해 ASCII 코드로 표현되는 두개의 16진수 숫자로 이루어진 '이스케이프' 문자로 바꾼다
 ~ : 126 (0x7E) : http://www.joews.hardware.com/%7Ejoe 
 빈 문자 : 32 (0x20) : http://www.joes-hardware.com/more%20tools.html 
 % : 37 (0x25) : http://www.joes-hardware.com/100%25satisfaction.html 

### 2.4.3 문자 제한
- 몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있음
- URL에서 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면, 그전에 반드시 인코딩해야함
- 예(%,/,.,..,#,?,;,:,$,+,@,$,=,{},<>, 0x00-0x1F, 0x7F, >0x7F 등)


## 2.5 스킴의 바다
- http: 사용자 이름이나 비밀번호가 없다는 것을 제외하고는, 일반 URL 포맷을 지키는 하이퍼텍스트 전송 프로토콜 스킴
- https: 위와 거의 같다, HTTP 커넥션의 양 끝단에서 암호화하기 위해 넷스케이프에서 개발한 보안 소켓 계층(SSL)을 사용한다는 것 뿐
- mailto: 이메일 주소를 가리킴
- ftp : 파일 전송 프로토콜은 ftp 서버에 있는 파일을 내려 받거나 올리고, ftp 서버의 디렉터리에 있는 콘텐츠 목록을 가져오는 데 사용할 수 있음
- rtsp, rtspu: 실시간 스트리밍 프로토콜을 통해서 읽을 수 있는 오디오 및 비디오와 같은 미디어 리소스 식별자 -> cctv 같은 데 사용되는 듯
- file : 주어진 호스트 기기에서 바로 접근할 수 있는 파일들을 나타냄
- news: 특정 문서나 뉴스 그룹에 접근하는 데 사용 -> 왜 필요한지 궁금
- telnet: 대화형 서비스에 접근하는 데 사용

